# Пошаговая инструкция по деплою Claude Telegram Bot на Railway

## Шаг 1: Подготовка репозитория

1. Создайте аккаунт на GitHub (если у вас его еще нет)
2. Создайте новый репозиторий на GitHub
3. Запушьте ваш код в репозиторий:
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git branch -M main
   git remote add origin https://github.com/ваш-логин/claude-telegram-bot.git
   git push -u origin main
   ```

## Шаг 2: Создание проекта на Railway

1. Перейдите на [railway.app](https://railway.app/) и войдите в аккаунт
2. Нажмите кнопку "New Project" на панели управления
3. Выберите "Deploy from GitHub repo"
4. Подключите ваш GitHub аккаунт (если еще не подключен)
5. Выберите репозиторий с кодом вашего бота

## Шаг 3: Настройка деплоя

1. Railway автоматически определит, что это Node.js проект
2. Настройки Build и Start команд должны быть установлены автоматически:
   - Build Command: `npm install`
   - Start Command: `node src/index.js`

## Шаг 4: Настройка переменных окружения

1. Перейдите на вкладку "Variables" в вашем проекте
2. Добавьте следующие переменные окружения:
   ```
   TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
   ANTHROPIC_API_KEY=your_anthropic_api_key_here
   ANTHROPIC_MODEL=claude-3-7-sonnet-20240307
   IS_HEROKU=true
   ```

## Шаг 5: Генерация публичного домена

1. Перейдите на вкладку "Settings" в вашем проекте
2. Нажмите на "Generate Domain"
3. Railway создаст публичный домен для вашего приложения
4. Скопируйте этот домен и добавьте его как переменную окружения:
   ```
   SERVER_URL=https://ваш-домен.railway.app
   ```

## Шаг 6: Проверка деплоя

1. Railway автоматически запустит деплой при изменении переменных окружения
2. Перейдите на вкладку "Deployments" чтобы увидеть процесс деплоя
3. Когда деплой завершится успешно, статус изменится на "Success"

## Шаг 7: Тестирование бота

1. Откройте Telegram и найдите вашего бота
2. Отправьте сообщение /start для проверки работы бота
3. Попробуйте отправить текстовое сообщение, изображение или файл

## Решение проблем

Если бот не отвечает:
1. Проверьте логи в Railway на вкладке "Deployments"
2. Убедитесь, что все переменные окружения установлены корректно
3. Проверьте статус сервиса на вкладке "Metrics"

## Заметки по работе с файлами

Ваш бот настроен для обработки файлов с использованием системы хранения в памяти. Загруженные файлы будут доступны в течение времени работы приложения, но будут утеряны при перезапуске сервиса.

Для продакшн-использования с большим количеством загрузок файлов рекомендуется использовать облачное хранилище, такое как AWS S3 или Google Cloud Storage. 